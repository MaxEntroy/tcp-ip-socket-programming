## chapter07 优雅的断开套接字连接

### Basic

q:tcp经常忽略的一点是什么？
>tcp的断开过程往往比建立连接的过程更重要，而这一重要性也很容易被忽略

q:单方面断开带来的问题?
1.tcp是全双工的，即read/write分别维护一个流，对应一个输入和输出缓冲区
2.单方面断开导致输入流/输出流同时断开

q:何谓优雅的断开？
>优雅的断开是指，在某一个时刻，只断开输入流/输出流某一个流。

q:为何需要半关闭(half-close)
1.当输入流/输出流某一个不需要使用，但是另一个还需要使用时，此时使用close会破坏这种情形，此时使用shutdown
2.当然，对于1中的case，我们也可以等待足够久之后，再关闭.作者举了文件传输的例子，
2.1.server端发送数据，client接受完成之后，回送信息
2.2.问题的关键自傲与，client怎么能知道接受完成，此时server端发送eof即可，但是如果使用close发送eof，会导致无法接受
2.3.所以，半关闭可以解决这个问题。关闭写端，client可以获取eof，接受完毕，接着会送数据即可，此时server端可以接受数据